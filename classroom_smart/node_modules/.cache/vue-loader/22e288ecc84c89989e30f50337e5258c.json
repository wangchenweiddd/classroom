{"remainingRequest":"D:\\WebstormProjects\\classroom_smart\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\WebstormProjects\\classroom_smart\\src\\components\\User\\DailyRecord.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\WebstormProjects\\classroom_smart\\src\\components\\User\\DailyRecord.vue","mtime":1599461025969},{"path":"D:\\WebstormProjects\\classroom_smart\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\WebstormProjects\\classroom_smart\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\WebstormProjects\\classroom_smart\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\WebstormProjects\\classroom_smart\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport moment from \"moment\";\n\nexport default {\n  name: \"DailyRecord\",\n  mounted() {\n    this.allDaily()\n  },\n  data() {\n      return {\n        modal1: false,\n        tableData: [],\n        timeRange: [],\n        startTime: '',\n        endTime: '',\n        detail: [],\n        data1: [],\n        columns1: [\n          {\n            title: '更新时间',\n            key: 'updateTime',\n            width: 150\n          },\n          {\n            title: '所属教室',\n            key: 'regionFullName'\n          },\n          {\n            title: '空调编号',\n            key: 'deviceId'\n          },\n          {\n            title: '空调名称',\n            key: 'fullName'\n          },\n          {\n            title: '操作编号',\n            key: 'operateId'\n          },\n          {\n            title: '操作结果',\n            key: 'status'\n          },\n        ]\n      }\n  },\n  methods:{\n    transformTime(data) {\n      return moment(data).format('YYYY-MM-DD HH:MM:SS')\n    },\n    handleClick(row) {\n      this.modal1 = true\n      this.data1 = []\n      this.$api.getDailyDetail(row.id, '总数').then(res => {\n        console.log('res',res)\n        this.detail = res.data.data\n        this.detail.forEach(item => {\n          item.airConControlLogEntity.regionFullName = item.airConRegionEntity.regionFullName\n          item.airConControlLogEntity.fullName = item.airConInfoEntity.fullName\n          item.airConControlLogEntity.updateTime = moment(item.airConControlLogEntity.updateTime).format('YYYY-MM-DD HH:MM:SS')\n          this.data1.push(item.airConControlLogEntity)\n        })\n        console.log('data1', this.data1)\n      })\n    },\n    ok() {\n      this.modal1 = false\n    },\n    allDaily() {\n      this.$api.getDailyData('160', '2020-05-28 00:00:00', '2020-12-31 00:00:00').then(res => {\n        console.log('res',res)\n        res.data.data.forEach(item => {\n          this.tableData.push(item.userOperateVo)\n        })\n        console.log('tableData',this.tableData)\n      })\n    },\n    selectTime(){\n      if (!this.timeRange) {\n        this.startTime = ''\n        this.endTime = ''\n      } else {\n        this.startTime = this.timeRange[0]\n        this.endTime = this.timeRange[1]\n      }\n      this.getServerList()\n    },\n    getServerList() {\n      this.tableData=[]\n      this.$api.getDailyData('160', this.startTime, this.endTime).then(res => {\n        console.log('res',res)\n        res.data.data.forEach(item => {\n          this.tableData.push(item.userOperateVo)\n        })\n        console.log('tableData',this.tableData)\n      })\n    }\n  }\n}\n",{"version":3,"sources":["DailyRecord.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DailyRecord.vue","sourceRoot":"src/components/User","sourcesContent":["<template>\r\n  <div>\r\n    <div style=\"display: flex;flex-direction: row;justify-content: space-between;margin-bottom: 10px\">\r\n      <h2>日志管理</h2>\r\n      <el-date-picker\r\n        v-model=\"timeRange\"\r\n        type=\"datetimerange\"\r\n        range-separator=\"-\"\r\n        format=\"yyyy-MM-dd HH:mm:ss\"\r\n        value-format=\"yyyy-MM-dd HH:mm:ss\"\r\n        start-placeholder=\"开始日期\"\r\n        end-placeholder=\"结束日期\"\r\n        @change=\"selectTime\">\r\n      </el-date-picker>\r\n    </div>\r\n    <div>\r\n      <el-table\r\n        :data=\"tableData\"\r\n        border\r\n        stripe\r\n        style=\"width: 100%\">\r\n        <el-table-column\r\n          prop=\"userId\"\r\n          label=\"用户id\"\r\n          align=\"center\">\r\n        </el-table-column>\r\n        <el-table-column\r\n          prop=\"property\"\r\n          label=\"控制类型\"\r\n          align=\"center\">\r\n        </el-table-column>\r\n        <el-table-column\r\n          prop=\"createTimeStr\"\r\n          label=\"创建时间\"\r\n          align=\"center\">\r\n        </el-table-column>\r\n        <el-table-column\r\n          prop=\"id\"\r\n          label=\"操作id\"\r\n          align=\"center\">\r\n        </el-table-column>\r\n        <el-table-column\r\n          label=\"查看详情\"\r\n          align=\"center\">\r\n          <template slot-scope=\"scope\">\r\n            <el-button\r\n              type=\"text\"\r\n              size=\"mini\"\r\n              @click=\"handleClick(scope.row)\">查看详情</el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n    </div>\r\n    <Modal\r\n      width=\"900px\"\r\n      v-model=\"modal1\"\r\n      title=\"查看日志详情\"\r\n      :mask-closable=\"false\">\r\n      <Table border :columns=\"columns1\" :data=\"data1\"></Table>\r\n      <div slot=\"footer\">\r\n        <Button type=\"primary\" @click=\"ok\" >确定</Button>\r\n      </div>\r\n    </Modal>\r\n  </div>\r\n\r\n\r\n</template>\r\n\r\n<script>\r\n    import moment from \"moment\";\r\n\r\n    export default {\r\n      name: \"DailyRecord\",\r\n      mounted() {\r\n        this.allDaily()\r\n      },\r\n      data() {\r\n          return {\r\n            modal1: false,\r\n            tableData: [],\r\n            timeRange: [],\r\n            startTime: '',\r\n            endTime: '',\r\n            detail: [],\r\n            data1: [],\r\n            columns1: [\r\n              {\r\n                title: '更新时间',\r\n                key: 'updateTime',\r\n                width: 150\r\n              },\r\n              {\r\n                title: '所属教室',\r\n                key: 'regionFullName'\r\n              },\r\n              {\r\n                title: '空调编号',\r\n                key: 'deviceId'\r\n              },\r\n              {\r\n                title: '空调名称',\r\n                key: 'fullName'\r\n              },\r\n              {\r\n                title: '操作编号',\r\n                key: 'operateId'\r\n              },\r\n              {\r\n                title: '操作结果',\r\n                key: 'status'\r\n              },\r\n            ]\r\n          }\r\n      },\r\n      methods:{\r\n        transformTime(data) {\r\n          return moment(data).format('YYYY-MM-DD HH:MM:SS')\r\n        },\r\n        handleClick(row) {\r\n          this.modal1 = true\r\n          this.data1 = []\r\n          this.$api.getDailyDetail(row.id, '总数').then(res => {\r\n            console.log('res',res)\r\n            this.detail = res.data.data\r\n            this.detail.forEach(item => {\r\n              item.airConControlLogEntity.regionFullName = item.airConRegionEntity.regionFullName\r\n              item.airConControlLogEntity.fullName = item.airConInfoEntity.fullName\r\n              item.airConControlLogEntity.updateTime = moment(item.airConControlLogEntity.updateTime).format('YYYY-MM-DD HH:MM:SS')\r\n              this.data1.push(item.airConControlLogEntity)\r\n            })\r\n            console.log('data1', this.data1)\r\n          })\r\n        },\r\n        ok() {\r\n          this.modal1 = false\r\n        },\r\n        allDaily() {\r\n          this.$api.getDailyData('160', '2020-05-28 00:00:00', '2020-12-31 00:00:00').then(res => {\r\n            console.log('res',res)\r\n            res.data.data.forEach(item => {\r\n              this.tableData.push(item.userOperateVo)\r\n            })\r\n            console.log('tableData',this.tableData)\r\n          })\r\n        },\r\n        selectTime(){\r\n          if (!this.timeRange) {\r\n            this.startTime = ''\r\n            this.endTime = ''\r\n          } else {\r\n            this.startTime = this.timeRange[0]\r\n            this.endTime = this.timeRange[1]\r\n          }\r\n          this.getServerList()\r\n        },\r\n        getServerList() {\r\n          this.tableData=[]\r\n          this.$api.getDailyData('160', this.startTime, this.endTime).then(res => {\r\n            console.log('res',res)\r\n            res.data.data.forEach(item => {\r\n              this.tableData.push(item.userOperateVo)\r\n            })\r\n            console.log('tableData',this.tableData)\r\n          })\r\n        }\r\n      }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n"]}]}